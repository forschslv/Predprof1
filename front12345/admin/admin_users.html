<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Пользователи - Админ</title>
    <link rel="stylesheet" href="/css/cafeteria_styles.css">
</head>
<body>
    <div class="container" style="max-width: 600px;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h1>Управление правами</h1>
            <button onclick="window.location.href='/admin/admin.html'" class="secondary" style="width:auto;">Назад в панель</button>
        </div>
        <div class="inventory-item">
            <p>Назначить/снять права администратора</p>
            <input type="email" id="userEmail" placeholder="Загрузка почты...">
            <select id="isAdmin">
                <option value="true">Сделать админом</option>
                <option value="false">Убрать из админов</option>
            </select>
            <label style="display:block; margin-top:10px;">Роль повара:
                <select id="isCook">
                    <option value="">-- без изменений --</option>
                    <option value="true">Сделать поваром</option>
                    <option value="false">Убрать роль повара</option>
                </select>
            </label>
            <button onclick="updateRole()">Применить</button>
        </div>
    </div>
    <script src="/js/script.js"></script>
    <script>
        checkAuth(); requireAdmin();
        async function updateRole() {
            const isCookVal = document.getElementById('isCook').value;
            const payload = {
                email: document.getElementById('userEmail').value,
                is_admin: document.getElementById('isAdmin').value === 'true'
            };
            if (isCookVal === 'true') payload.is_cook = true;
            if (isCookVal === 'false') payload.is_cook = false;
            try {
                await apiRequest('/admin/users/by-email', 'PATCH', payload);
                alert("Права обновлены!");
            } catch(e) { alert(e.message); }
        }
    </script>
</body>
</html>